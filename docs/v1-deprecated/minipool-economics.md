# Minipool Economics

## Overview

QuantaPool's minipool system allows node operators to run validators with reduced capital requirements by combining their bond with pooled user deposits. This creates aligned incentives between operators and depositors.

## Bond Types

### Quarter Bond (Recommended for MVP)

| Component | Amount |
|-----------|--------|
| Operator Bond | 10,000 QRL |
| Pooled from Users | 30,000 QRL |
| **Total Validator** | **40,000 QRL** |

- Most capital-efficient for operators
- Higher leverage = higher risk/reward
- Requires robust slashing protection

### Half Bond

| Component | Amount |
|-----------|--------|
| Operator Bond | 20,000 QRL |
| Pooled from Users | 20,000 QRL |
| **Total Validator** | **40,000 QRL** |

- Lower leverage, lower risk
- More skin-in-the-game from operator
- May be preferred for conservative operators

## Commission Structure

Operators earn commission on rewards generated by the pooled portion of their validator. Recommended: **10-15%** commission rate.

### How Commission Works

1. Validator earns total rewards (proposals + attestations)
2. Rewards split proportionally between operator bond and pooled funds
3. Operator takes commission percentage from pooled portion only
4. Remaining pooled rewards go to stQRL holders via exchange rate increase

### Example: Quarter Bond at 10% Commission

**Assumptions:**
- Annual validator rewards: 1,000 QRL
- Operator bond: 10,000 QRL (25% of validator)
- Pooled funds: 30,000 QRL (75% of validator)

**Calculation:**

```
Total rewards:                    1,000 QRL

Operator's share (25%):             250 QRL
Pooled share (75%):                 750 QRL

Commission on pooled (10%):          75 QRL  → to Operator
Net to pool:                        675 QRL  → to stQRL holders

OPERATOR TOTAL:                     325 QRL on 10,000 QRL = 3.25% APY
POOL DEPOSITORS:                    675 QRL on 30,000 QRL = 2.25% APY
```

### Example: Half Bond at 15% Commission

**Assumptions:**
- Annual validator rewards: 1,000 QRL
- Operator bond: 20,000 QRL (50% of validator)
- Pooled funds: 20,000 QRL (50% of validator)

**Calculation:**

```
Total rewards:                    1,000 QRL

Operator's share (50%):             500 QRL
Pooled share (50%):                 500 QRL

Commission on pooled (15%):          75 QRL  → to Operator
Net to pool:                        425 QRL  → to stQRL holders

OPERATOR TOTAL:                     575 QRL on 20,000 QRL = 2.875% APY
POOL DEPOSITORS:                    425 QRL on 20,000 QRL = 2.125% APY
```

## Operator Incentives

### Why Run a Node?

1. **Higher Returns**: Commission boosts operator APY above solo staking
2. **Capital Efficiency**: Earn on borrowed capital
3. **Network Participation**: Support QRL decentralization
4. **Early Mover Advantage**: First operators in new ecosystem

### Operator Requirements

| Requirement | Details |
|-------------|---------|
| Minimum Bond | 10,000 QRL (Quarter) or 20,000 QRL (Half) |
| Collateral | Additional bond for slashing protection |
| Infrastructure | go-zond + qrysm running 24/7 |
| Uptime | Target >99% for optimal rewards |

## Slashing Protection

### The Problem

If a validator is slashed (double signing, surround voting), the entire 40,000 QRL stake is at risk. Pool depositors shouldn't lose funds due to operator negligence.

### The Solution: Operator Collateral

Operators must stake additional QRL as collateral that can be slashed to cover pool losses:

```
Recommended Collateral: 5,000 QRL per minipool

Slashing scenario:
- Validator slashed 1,000 QRL
- Operator's 10,000 QRL bond absorbs proportional loss (250 QRL)
- Pool's 30,000 QRL portion would lose 750 QRL
- Operator collateral covers the 750 QRL pool loss
- Pool depositors made whole
```

### Collateral Release

- Collateral locked for validator lifetime
- Released when validator fully exits
- Slashed proportionally to cover any losses

## Exchange Rate Mechanics

### How stQRL Appreciates

```
Day 1:
- Total staked: 100,000 QRL
- Total stQRL: 100,000 stQRL
- Exchange rate: 1.0 QRL per stQRL

Day 365 (after 2,000 QRL rewards, net of commission):
- Total staked: 102,000 QRL
- Total stQRL: 100,000 stQRL (unchanged)
- Exchange rate: 1.02 QRL per stQRL
```

### Benefits of Exchange Rate Model

1. **No Rebasing**: Wallet balance stays constant
2. **DeFi Compatible**: Works in AMMs, lending, etc.
3. **Tax Efficiency**: No taxable events until withdrawal
4. **Simple Accounting**: Track cost basis easily

## Pool Activation Delays

### The 40,000 QRL Threshold

Deposits wait in queue until 40,000 QRL accumulates:

```
Scenario: Low deposit volume

Day 1: 10,000 QRL deposited → queue: 10,000
Day 5: 5,000 QRL deposited  → queue: 15,000
Day 10: 8,000 QRL deposited → queue: 23,000
Day 15: 20,000 QRL deposited → queue: 43,000
        ↓
        40,000 QRL → creates validator
        3,000 QRL → remains in queue
```

### UX Considerations

- Show estimated activation time based on deposit velocity
- Display queue position clearly
- Consider minimum viable deposit to prevent dust
- Funds earn rewards only after validator activation

## Fee Structure Summary

| Fee Type | Recipient | Typical Rate |
|----------|-----------|--------------|
| Commission | Node Operator | 10-15% of pooled rewards |
| Protocol Fee | QuantaPool Treasury | 0-5% (optional, for sustainability) |
| Withdrawal Fee | Protocol | 0% (recommended for adoption) |

## Comparison: QuantaPool vs Solo Staking

| Factor | Solo Staking | QuantaPool (Depositor) | QuantaPool (Operator) |
|--------|--------------|------------------------|----------------------|
| Minimum | 40,000 QRL | Any amount | 10,000-20,000 QRL |
| Infrastructure | Required | None | Required |
| Liquidity | Locked | stQRL tradeable | Bond locked |
| APY | ~2.5% base | ~2.25% (after commission) | ~3.25% (with commission) |
| Slashing Risk | Full exposure | Protected by collateral | Collateral at risk |
